<html>
<link href='navstyle.css' rel='stylesheet'>
<link href='progressLog.css' rel='stylesheet'>
<link href='pageTemplate.css' rel='stylesheet'>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="icon" type="image/png" href="https://bruceblacklock.com/MadMinute.png">

<style type="text/css">
    #topNavBuffer2 {
        height: 77px;
    }

    .base-timer {
        position: relative;
        width: 100px;
        height: 100px;
        margin: auto;
        padding-top: 20px;
    }

    .base-timer__svg {
        transform: scaleX(-1);
    }

    .base-timer__circle {
        fill: none;
        stroke: none;
    }

    .base-timer__path-elapsed {
        stroke-width: 7px;
        stroke: grey;
    }

    .base-timer__path-remaining {
        stroke-width: 7px;
        stroke-linecap: round;
        transform: rotate(90deg);
        transform-origin: center;
        transition: 1s linear all;
        fill-rule: nonzero;
        stroke: currentColor;
    }

    .base-timer__path-remaining.green {
        color: rgb(65, 184, 131);
    }

    .base-timer__path-remaining.orange {
        color: orange;
    }

    .base-timer__path-remaining.red {
        color: red;
    }

    .base-timer__label {
        position: absolute;
        width: 100px;
        height: 100px;
        top: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        padding-top: 40px;
    }

    .selectButton {
        display: block;
        font-size: 1.5em;
        margin-block-start: 0.83em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        font-weight: bold;
        padding-top: 25px;
        padding-bottom: 25px;
        min-width: 135px;
        position: relative;
        background-color: grey;
        width: 40%;
        display: inline-block;
        bottom: 10%;
        text-align: center;
        border-radius: 8px;
        cursor: pointer;
        border: none;
    }

    .selectButton:hover {
        background-color: purple;
        color: white;
    }

    .reportCell {
        text-align: center;
    }


    #report th {
        border-bottom: 3px solid white;
        width: 130px;
    }

    #mainTitle {
        /* font-family: "Comic Sans MS", cursive, sans-serif; */
        font-size: 400%;
        text-align: center;
    }

    .multiplicationTitle {

        font-size: 200%;
    }

    #divisionTitle {
        font-size: 200%;
    }

    .prompt {
        font-size: 100%;
    }

    #mmImage {
        vertical-align: middle;
        height: 150px;
        margin-left: 20px;
    }

    #mmImage2 {
        vertical-align: middle;
        height: 150px;
        margin-right: 20px;
    }

    #app {
        margin: auto;
    }

    #answer {
        display: inline-block;
        font-size: 400%;
    }

    #QnA {
        display: inline-block;
        font-size: 400%;
    }

    #questionAnswerFeedback {
        text-align: center;
        margin-top: 50px;
    }

    #feedback {
        font-size: 400%;
        display: inline-block;
        margin-left: 30px;
    }
</style>

<head>

    <title>
        Mad Minutes
    </title>




</head>

<body>

    <audio id="correct">
        <source src="correct_1.wav" type="audio/ogg">
    </audio>

    <audio id="wrong">
        <source src="wrong.mp3" type="audio/ogg">
    </audio>

    <div id="AllButFooter">


        <div id="topNavBuffer2"></div>
        <div id="notNav">
            <div id="chemistrymap" style="display: block;">
                <div id="testOptions">
                    <div id="mainTitle"><img src="https://bruceblacklock.com/MadMinute.png" id="mmImage2">MAD
                        MINUTES!</div><br>
                        <span class="multiplicationTitle">Addition</span><br>
                        <span class="prompt">Choose your addition level. You have 2 minutes to solve 15
                            problems.</span><br>
                        <button class="selectButton" type="button" onclick="setPage(2,0)"
                            style="width: 150px">0s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,1)"
                            style="width: 150px">1s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,2)"
                            style="width: 150px">2s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,3)"
                            style="width: 150px">3s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,4)"
                            style="width: 150px">4s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,5)"
                            style="width: 150px">5s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,6)"
                            style="width: 150px">6s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,7)"
                            style="width: 150px">7s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,8)"
                            style="width: 150px">8s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,9)"
                            style="width: 150px">9s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,10)"
                            style="width: 150px">10s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,11)"
                            style="width: 150px">11s</button>
                        <button class="selectButton" type="button" onclick="setPage(2,12)"
                            style="width: 150px">12s</button><br><br>

                            <span class="multiplicationTitle">Subtraction</span><br>
                            <span class="prompt">Choose your subtraction level. You have 2 minutes to solve 10
                                problems.</span><br>
                            <button class="selectButton" type="button" onclick="setPage(3,0)"
                                style="width: 150px">0s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,1)"
                                style="width: 150px">1s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,2)"
                                style="width: 150px">2s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,3)"
                                style="width: 150px">3s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,4)"
                                style="width: 150px">4s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,5)"
                                style="width: 150px">5s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,6)"
                                style="width: 150px">6s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,7)"
                                style="width: 150px">7s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,8)"
                                style="width: 150px">8s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,9)"
                                style="width: 150px">9s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,10)"
                                style="width: 150px">10s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,11)"
                                style="width: 150px">11s</button>
                            <button class="selectButton" type="button" onclick="setPage(3,12)"
                                style="width: 150px">12s</button><br><br>

                    <span class="multiplicationTitle">Multiplication</span><br>
                    <span class="prompt">Choose your multiplication level. You have 2 minutes to solve 15
                        problems.</span><br>
                    <button class="selectButton" type="button" id="Zeroes" onclick="setPage(0,0)"
                        style="width: 150px">0s</button>
                    <button class="selectButton" type="button" id="Ones" onclick="setPage(0,1)"
                        style="width: 150px">1s</button>
                    <button class="selectButton" type="button" id="Twos" onclick="setPage(0,2)"
                        style="width: 150px">2s</button>
                    <button class="selectButton" type="button" id="Threes" onclick="setPage(0,3)"
                        style="width: 150px">3s</button>
                    <button class="selectButton" type="button" id="Fours" onclick="setPage(0,4)"
                        style="width: 150px">4s</button>
                    <button class="selectButton" type="button" id="Fives" onclick="setPage(0,5)"
                        style="width: 150px">5s</button>
                    <button class="selectButton" type="button" id="Sixs" onclick="setPage(0,6)"
                        style="width: 150px">6s</button>
                    <button class="selectButton" type="button" id="Sevens" onclick="setPage(0,7)"
                        style="width: 150px">7s</button>
                    <button class="selectButton" type="button" id="Eights" onclick="setPage(0,8)"
                        style="width: 150px">8s</button>
                    <button class="selectButton" type="button" id="Nines" onclick="setPage(0,9)"
                        style="width: 150px">9s</button>
                    <button class="selectButton" type="button" id="Tens" onclick="setPage(0,10)"
                        style="width: 150px">10s</button>
                    <button class="selectButton" type="button" id="Elevens" onclick="setPage(0,11)"
                        style="width: 150px">11s</button>
                    <button class="selectButton" type="button" id="Twelves" onclick="setPage(0,12)"
                        style="width: 150px">12s</button><br><br>

                    <span class="multiplicationTitle">Division</span><br>
                    <span class="prompt">Choose your division level. You have 2 minutes to solve 10 problems.</span><br>
                    <button class="selectButton" type="button" onclick="setPage(1,1)" style="width: 150px">1s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,2)" style="width: 150px">2s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,3)" style="width: 150px">3s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,4)" style="width: 150px">4s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,5)" style="width: 150px">5s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,6)" style="width: 150px">6s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,7)" style="width: 150px">7s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,8)" style="width: 150px">8s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,9)" style="width: 150px">9s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,10)" style="width: 150px">10s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,11)" style="width: 150px">11s</button>
                    <button class="selectButton" type="button" onclick="setPage(1,12)" style="width: 150px">12s</button>
                </div>
                <div id="testDiv" style="display:none;">
                    <div id="app"></div>
                    <div id="questionAnswerFeedback">
                        <div id="QnA"></div>
                        <input type="text" id="answer" size="1">
                        <div id="feedback"></div>
                    </div>
                </div>
                <div id="result" style="display:none;"></div>
                <div id="tableDIV">
                </div>
                <button class="selectButton" type="button" id="Before" style="width: 150px; display: none;"
                    onclick="back()">BACK</button>
                <button class="selectButton" type="button" id="After" style="width: 150px; display: none;"
                    onclick="proceed()"></button>
            </div>
        </div>
    </div>


    <div id="bottomBuffer"></div>
    <div id="footer" style="display:block">
    </div>
</body>


<script>
    var numberInQuestion;
    var answer;
    var question;
    var questions = [];
    var passed;
    var quiz;

    var afterButton = document.getElementById("After");
    var feedbackDiv = document.getElementById("feedback");
    var resultDiv = document.getElementById("result");
    var reportDiv = document.getElementById("report");
    var beforeButton = document.getElementById("Before");
    var testOptionsDiv = document.getElementById("testOptions");
    var testDiv = document.getElementById("testDiv");
    var baseTimer = document.getElementById("base-timer");
    var QnADiv = document.getElementById("QnA");
    var answerInput = document.getElementById('answer');
    var correctDiv = document.getElementById("correct");
    var wrongDiv = document.getElementById("wrong");
    var appTimer = document.getElementById("app");
    var baseTimerLabel = document.getElementById("base-timer-label");
    var baseTimerPathRemaining = document.getElementById("base-timer-path-remaining");

    function proceed() {
        if (passed == true) {
            passed = false;
            numberInQuestion++;
        }
        setPage(quiz, numberInQuestion)
    }

    function back() {
        afterButton.style.display = "none";
        feedbackDiv.innerHTML = "";
        resultDiv.style.display = "none";
        document.getElementById("report").style.display = "none";
        beforeButton.style.display = "none";
        testOptionsDiv.style.display = "block";
    }

    function setPage(quizType, quizNumber) {
        afterButton.style.display = "none";
        feedbackDiv.innerHTML = "";
        resultDiv.style.display = "none";
        console.log("The page is being set! We're on number: " + numberInQuestion);
        numberOfQuestions = 0;
        numberCorrect = 0;
        questions = [];
        timeLeft = 120;
        timePassed = 0;

        testOptionsDiv.style.display = "none";

        quiz = quizType;
        numberInQuestion = quizNumber;

        document.getElementById("tableDIV").innerHTML = `
        <table id="report" style="display:none">
            <tr>
                <th>Question</th>
                <th>Your Answered</th>
                <th>Points</th>
            </tr>
        </table>`

        nextQuestion();
        testDiv.style.display = "block";
        document.getElementById("base-timer").style.display = "block";
        startTimer();
    }

    function nextQuestion() {
        numberOfQuestions++;
        generateNextQuestion();
        QnADiv.innerHTML = question + " = ";
        answerInput.value = '';
    }

    function generateNextQuestion() {

        while (true) {
            var nextNumber = Math.floor(Math.random() * 10);
            var questionType = Math.floor((Math.random() * 2) + 1);
            console.log("This is the quiz value:"+quiz);

            answer = numberInQuestion * nextNumber;

            if (quiz == 0) {
                if (questionType == 1) {
                    question = nextNumber + " x " + numberInQuestion;
                }
                else {
                    question = numberInQuestion + " x " + nextNumber;
                }
                if (!questions.includes(question)) {
                    questions.push(question);
                    return;
                }
            }
            if (quiz == 2) {
                if (questionType == 1) {
                    question = nextNumber + " + " + numberInQuestion;
                }
                else {
                    question = numberInQuestion + " + " + nextNumber;
                }
                if (!questions.includes(question)) {
                    questions.push(question);
                    answer = nextNumber + numberInQuestion
                    return;
                }
            }
            if (quiz == 3) {
                if (nextNumber >= numberInQuestion) {
                    question = nextNumber + " - " + numberInQuestion;
                    answer = nextNumber - numberInQuestion
                }
                else {
                    question = numberInQuestion + " - " + nextNumber;
                    answer = numberInQuestion - nextNumber
                }
                if (!questions.includes(question)) {
                    
                    questions.push(question);
                    return;
                }
            }
            if (quiz == 1){
                question = answer + " / " + numberInQuestion;
                answer = nextNumber;
                if (!questions.includes(question)) {
                    questions.push(question);
                    return;
                }
            }


            // console.log("You already did " + question + " eh?")
        }

    }




    function checkQuestion() {
        var studentAnswer = answerInput.value;
        if (studentAnswer == "") { return; }
        var row = document.getElementById("report").insertRow(numberOfQuestions)
        var cell1 = row.insertCell(0);
        var cell3 = row.insertCell(1);
        var cell4 = row.insertCell(2);
        cell1.innerHTML = question + " = " + answer;
        cell3.innerHTML = studentAnswer;
        cell1.className = "reportCell"
        cell3.className = "reportCell"
        cell4.className = "reportCell"

        if (studentAnswer == answer) {
            feedbackDiv.innerHTML = "✓"
            feedbackDiv.style.color = "green"
            correctDiv.play();
            numberCorrect++;
            cell4.innerHTML = "✓";
            cell4.style.color = "green";
        }
        else {
            feedbackDiv.innerHTML = "X"
            feedbackDiv.style.color = "red"
            wrongDiv.play();
            cell4.innerHTML = "X";
            cell4.style.color = "red";
        }
        if ((numberOfQuestions == 15 && quiz == 0) || (numberOfQuestions == 10 && quiz == 1) || (numberOfQuestions == 15 && quiz == 2) || (numberOfQuestions == 10 && quiz == 3)) {
            validate()
        }
        else {
            nextQuestion()
        }
    }

    function validate() {
        clearInterval(timerInterval);

        var minutes = Math.floor(timePassed / 60);
        var seconds = timePassed - minutes * 60;
        var finalTime;
        if (minutes > 0) {
            if (minutes > 1) {
                finalTime = minutes + " minutes";
            }
            else {
                finalTime = minutes + " minute";
            }
            if (seconds > 0) {
                finalTime.concat(" and " + seconds + " seconds");
            }
        }
        else {
            finalTime = seconds + " seconds"
        }
        var nexter = numberInQuestion + 1;
        verificationCode = Math.floor(Math.random() * 1000); 
        if ((numberCorrect >= 14 && quiz == 0) || (numberCorrect >= 9 && quiz == 1) || (numberCorrect >= 14 && quiz == 2) || (numberCorrect >= 9 && quiz == 3)) {
            if(verificationCode % 2 != 0){
                verificationCode--;
            }
            resultDiv.innerHTML = "YOU PASSED WITH " + numberCorrect + "/" + numberOfQuestions + " (" + (Math.round(numberCorrect / numberOfQuestions * 100)) + "%) <br> Time: " + finalTime + "<br> Next time try your " + (nexter) + "s <br> Verification Code: "+ verificationCode;
            resultDiv.style.display = "block";

            afterButton.innerHTML = "NEXT";

            passed = true;
        }
        else {
            if(verificationCode % 2 == 0){
                verificationCode++;
            }
            resultDiv.innerHTML = "TRY AGAIN: " + numberCorrect + "/" + numberOfQuestions + " (" + (Math.round(numberCorrect / numberOfQuestions * 100)) + "%) <br> Time: " + finalTime + "<br> Verification Code: "+ verificationCode;
            resultDiv.style.display = "block";
            afterButton.innerHTML = "RETRY";
            passed = false
        }
        document.getElementById("report").style.display = "block";
        beforeButton.style.display = "inline-block";
        testDiv.style.display = "none";
        if (numberInQuestion != 12) {
            afterButton.style.display = "inline-block";
        }
        document.getElementById("base-timer").style.display = "none";
    }

    answerInput.addEventListener("keydown", function (e) {
        if (e.keyCode === 13) {  //checks whether the pressed key is "Enter"
            checkQuestion()
        }
    });



    // Credit: Mateusz Rybczonec

    var FULL_DASH_ARRAY = 283;
    var WARNING_THRESHOLD = 30;
    var ALERT_THRESHOLD = 10;

    const COLOR_CODES = {
        info: {
            color: "green"
        },
        warning: {
            color: "orange",
            threshold: WARNING_THRESHOLD
        },
        alert: {
            color: "red",
            threshold: ALERT_THRESHOLD
        }
    };

    var TIME_LIMIT = 120;
    var timePassed = 0;
    var timeLeft = TIME_LIMIT;
    var timerInterval = null;
    var remainingPathColor = COLOR_CODES.info.color;

    generateTimer()

    function generateTimer() {
        appTimer.innerHTML = `
<div class="base-timer" id="base-timer">
  <svg class="base-timer__svg" viewBox="0 0 100 100" xmlns="https://www.w3.org/2000/svg">
    <g class="base-timer__circle">
      <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>
      <path
        id="base-timer-path-remaining"
        stroke-dasharray="283"
        class="base-timer__path-remaining ${remainingPathColor}"
        d="
          M 50, 50
          m -45, 0
          a 45,45 0 1,0 90,0
          a 45,45 0 1,0 -90,0
        "
      ></path>
    </g>
  </svg>
  <span id="base-timer-label" class="base-timer__label">${formatTime(
            timeLeft
        )}</span>
</div>
`;
    }


    function onTimesUp() {
        clearInterval(timerInterval);
        validate()
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            timePassed = timePassed += 1;
            timeLeft = TIME_LIMIT - timePassed;
            document.getElementById("base-timer-label").innerHTML = formatTime(
                timeLeft
            );
            setCircleDasharray();
            setRemainingPathColor(timeLeft);

            if (timeLeft === 0) {
                onTimesUp();
            }
        }, 1000);
    }

    function formatTime(time) {
        const minutes = Math.floor(time / 60);
        let seconds = time % 60;

        if (seconds < 10) {
            seconds = `0${seconds}`;
        }

        return `${minutes}:${seconds}`;
    }

    function setRemainingPathColor(timeLeft) {
        const { alert, warning, info } = COLOR_CODES;
        if (timeLeft <= alert.threshold) {
            document
                .getElementById("base-timer-path-remaining")
                .classList.remove(warning.color);
            document
                .getElementById("base-timer-path-remaining")
                .classList.add(alert.color);
        } else if (timeLeft <= warning.threshold) {
            document
                .getElementById("base-timer-path-remaining")
                .classList.remove(info.color);
            document
                .getElementById("base-timer-path-remaining")
                .classList.add(warning.color);
        }
    }

    function calculateTimeFraction() {
        const rawTimeFraction = timeLeft / TIME_LIMIT;
        return rawTimeFraction - (1 / TIME_LIMIT) * (1 - rawTimeFraction);
    }

    function setCircleDasharray() {
        const circleDasharray = `${(
            calculateTimeFraction() * FULL_DASH_ARRAY
        ).toFixed(0)} 283`;
        document
            .getElementById("base-timer-path-remaining")
            .setAttribute("stroke-dasharray", circleDasharray);
    }
</script>

</html>
